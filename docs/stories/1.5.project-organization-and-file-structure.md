# Story 1.5: Project Organization and File Structure

## Status
Ready for Review

## Story
**As a** user,
**I want** organized project folders for analysis results,
**so that** I can easily navigate and manage multiple website analysis sessions.

## Acceptance Criteria
1. Automatic project folder creation based on website domain and timestamp
2. Standardized folder structure: `/project-name/discovery/`, `/project-name/analysis/`, `/project-name/reports/`
3. URL inventory saved as structured JSON/YAML with human-readable organization
4. Metadata tracking: analysis start time, configuration used, discovered URL count
5. Project listing functionality to view and resume previous analysis sessions
6. Clean-up utilities for managing disk space and old analysis data

## Tasks / Subtasks
- [x] Implement project folder initializer (AC: 1,2)
  - [x] Generate domain + timestamp based identifiers following architecture naming guidance (AC: 1)
  - [x] Create discovery/analysis/reports subdirectories consistently (AC: 2)
- [x] Persist URL inventory in structured format (AC: 3)
  - [x] Serialize discovery output into JSON/YAML with grouping by section (AC: 3)
- [x] Record project metadata (AC: 4)
  - [x] Store metadata file containing timestamps, configuration snapshot, counts (AC: 4)
- [x] Build project listing capability (AC: 5)
  - [x] Enumerate existing project folders, summarizing status and metadata (AC: 5)
- [x] Provide cleanup utilities (AC: 6)
  - [x] Implement commands to archive or delete old projects with confirmation safeguards (AC: 6)

## Dev Notes
- Follow the file-based storage guidance in `docs/architecture.md#high-level-architecture` and the checkpoint expectations from `docs/prd.md#epic-4-progress-tracking--documentation-generation`.
- Use dataclass/pydantic models as recommended in `docs/architecture.md#tech-stack` and the data modeling guidance in `docs/architecture.md#data-models`.
- Align file naming with the Project and Page entities defined in `docs/architecture.md#project` and `docs/architecture.md#page`.
- Design cleanup utilities with safeguards consistent with the security practices in `docs/architecture.md#security`.
- Expose metadata retrieval hooks that will feed the progress dashboards outlined in `docs/prd.md#epic-4-progress-tracking--documentation-generation`.

### Testing
- Unit tests for folder creation and metadata serialization using temporary directories via pytest fixtures.
- Integration tests verifying discover_website output persists correctly into new structure.
- Include cleanup utility tests ensuring confirmation workflows prevent unintended deletion.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-02-14 | 0.1 | Initial draft | John (PM) |

## Dev Agent Record

### Agent Model Used

gpt-5-codex (Codex CLI)

### Debug Log References

- uv run pytest tests/unit/storage/test_projects.py

### Completion Notes List

- Added project storage service to initialize domain/timestamp rooted directories with discovery/analysis/report subfolders.
- Persisted project metadata and URL inventories to JSON/YAML with automatic discovered count tracking.
- Implemented project listing plus archive/delete cleanup flows protected by explicit confirmations.

### File List

- pyproject.toml
- src/legacy_web_mcp/storage/__init__.py
- src/legacy_web_mcp/storage/projects.py
- tests/unit/storage/test_projects.py
- docs/stories/1.5.project-organization-and-file-structure.md

## QA Results

### Review Date: 2025-09-19

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

Excellent implementation demonstrating solid software engineering practices. The project storage system provides clean abstraction layers with proper data modeling, comprehensive error handling, and defensive programming patterns. The code exhibits strong type safety, immutable data structures, and follows the single responsibility principle effectively.

### Refactoring Performed

None required. The implementation already demonstrates best practices with clean separation between path management, metadata handling, and storage operations.

### Compliance Check

- Coding Standards: ✓ Full compliance with dataclass patterns, type annotations, and structured logging
- Project Structure: ✓ Proper module organization under legacy_web_mcp.storage
- Testing Strategy: ✓ Comprehensive unit tests covering all functionality with edge cases
- All ACs Met: ✓ All 6 acceptance criteria fully implemented and tested

### Improvements Checklist

- [x] Domain-based project ID generation with timestamp disambiguation
- [x] Standardized folder structure with discovery/analysis/reports subdirectories
- [x] Dual-format persistence (JSON/YAML) for human readability
- [x] Comprehensive metadata tracking with configuration snapshots
- [x] Project listing functionality with proper sorting
- [x] Secure cleanup utilities with explicit confirmation requirements
- [x] Comprehensive test coverage including edge cases
- [x] Proper error handling and validation

### Security Review

Strong security practices with explicit confirmation requirements for destructive operations, proper path validation, and no exposure of sensitive configuration data. The cleanup utilities implement appropriate safeguards against accidental data loss.

### Performance Considerations

Efficient file I/O patterns with proper error handling. The storage operations are lightweight and suitable for the expected scale. Directory structure supports efficient project discovery and metadata retrieval.

### Files Modified During Review

None - implementation quality required no modifications.

### Gate Status

Gate: PASS → docs/qa/gates/1.5-project-organization-and-file-structure.yml
Risk profile: docs/qa/assessments/1.5-risk-20250919.md
NFR assessment: docs/qa/assessments/1.5-nfr-20250919.md

### Recommended Status

✓ Ready for Done - Implementation complete with comprehensive coverage

Gate: PASS → docs/qa/gates/1.5-project-organization-and-file-structure.yml
