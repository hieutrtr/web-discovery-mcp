# Test Design: Story 1.1

Date: 2025-09-18
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 9
- Unit tests: 3 (33%)
- Integration tests: 5 (56%)
- E2E tests: 1 (11%)
- Priority distribution: P0: 3, P1: 5, P2: 1, P3: 0

## Test Scenarios by Acceptance Criteria

### AC1: Python 3.11 project structure created with proper package organization

| ID             | Level       | Priority | Test                                                                 | Justification |
| -------------- | ----------- | -------- | -------------------------------------------------------------------- | ------------- |
| 1.1-UNIT-001   | Unit        | P0       | Import `legacy_web_mcp` package and assert `__version__` + module load | Critical bootstrapping logic is pure and must fail fast |
| 1.1-INT-001    | Integration | P0       | Invoke CLI entrypoint via `legacy_web_mcp.cli.main()` and assert FastMCP instance configuration | Verifies orchestrated module wiring beyond pure functions |

### AC2: FastMCP framework integrated and basic MCP server responds to ping requests

| ID             | Level       | Priority | Test                                                                                   | Justification |
| -------------- | ----------- | -------- | -------------------------------------------------------------------------------------- | ------------- |
| 1.1-UNIT-002   | Unit        | P0       | Call `server.ping()` coroutine and validate payload keys (`status`, timestamps, versions) | Ensures critical health contract without external dependencies |
| 1.1-INT-002    | Integration | P1       | Use FastMCP client to connect to `create_mcp()` instance and invoke `ping` via RPC     | Validates tool registration and JSON-RPC plumbing |
| 1.1-E2E-001    | E2E         | P1       | Launch `uv run legacy-web-mcp` in stdio transport and assert ping response through CLI client | Confirms full deployment path from CLI to MCP protocol |

### AC3: Development environment setup with linting, formatting, and basic testing framework

| ID             | Level       | Priority | Test                                                                     | Justification |
| -------------- | ----------- | -------- | ------------------------------------------------------------------------ | ------------- |
| 1.1-INT-003    | Integration | P1       | Run `uv run ruff check`, `uv run ruff format --check`, `uv run mypy`, and `uv run pytest` sequentially | Ensures tooling commands execute against project configuration |

### AC4: Git repository initialized with appropriate .gitignore and README

| ID             | Level       | Priority | Test                                                                   | Justification |
| -------------- | ----------- | -------- | ---------------------------------------------------------------------- | ------------- |
| 1.1-INT-004    | Integration | P2       | Markdown linter verifies README sections + automated check for `.gitignore` required patterns | Repository assets validated via doc tooling without manual review |

### AC5: Basic CI/CD pipeline configured for automated testing

| ID             | Level       | Priority | Test                                                                   | Justification |
| -------------- | ----------- | -------- | ---------------------------------------------------------------------- | ------------- |
| 1.1-INT-005    | Integration | P1       | Dry-run GitHub Actions workflow (`act` or workflow parser) to confirm uv sync + lint/type/test steps | Confirms CI automation runs matching local tooling |

### AC6: Environment variable template created for configuration management

| ID             | Level       | Priority | Test                                                                   | Justification |
| -------------- | ----------- | -------- | ---------------------------------------------------------------------- | ------------- |
| 1.1-UNIT-003   | Unit        | P1       | Parse `.env.template` and assert required keys (`OPENAI_API_KEY`, models, storage paths) exist | Pure configuration validation suitable for unit coverage |

## Risk Coverage

Risk profile not yet defined for this story; scenarios emphasize bootstrapping reliability and developer workflow integrity.

## Recommended Execution Order

1. P0 unit tests (1.1-UNIT-001, 1.1-UNIT-002)
2. P0 integration tests (1.1-INT-001)
3. Remaining P1 unit/integration/E2E tests (1.1-INT-002, 1.1-E2E-001, 1.1-INT-003, 1.1-UNIT-003, 1.1-INT-005)
4. P2 integration test (1.1-INT-004)

## Gate Summary

```yaml
test_design:
  scenarios_total: 9
  by_level:
    unit: 3
    integration: 5
    e2e: 1
  by_priority:
    p0: 3
    p1: 5
    p2: 1
    p3: 0
  coverage_gaps: []
```

## Trace References

Test design matrix: docs/qa/assessments/1.1-test-design-20250918.md
P0 tests identified: 3
