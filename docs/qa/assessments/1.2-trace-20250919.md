# Requirements Traceability Matrix

## Story: 1.2 - Health Check and Diagnostic Tools

### Coverage Summary

- Total Requirements: 6
- Fully Covered: 6 (100%)
- Partially Covered: 0 (0%)
- Not Covered: 0 (0%)

### Requirement Mappings

#### AC1: MCP tool `health_check`
- `tests/unit/mcp/test_diagnostics.py::test_perform_health_check`
  - Given: FastMCP instance with stubbed browser/LLM probes
  - When: `perform_health_check` executes
  - Then: Response includes server metadata, environment summary, browser checks, and LLM status entries
- `tests/unit/test_server.py::test_create_mcp_registers_ping_tool`
  - Given: `create_mcp()` factory
  - When: Listing registered tools
  - Then: `health_check` is present alongside diagnostics tools

#### AC2: MCP tool `validate_dependencies`
- `tests/unit/mcp/test_diagnostics.py::test_gather_dependency_report`
  - Given: Stubbed Playwright checker returning missing browser
  - When: Gathering dependency report
  - Then: Response lists missing browser and remediation guidance

#### AC3: MCP tool `test_llm_connectivity`
- `tests/unit/mcp/test_diagnostics.py::test_gather_llm_connectivity_handles_missing_keys`
  - Given: All LLM env vars cleared
  - When: Connectivity report gathered
  - Then: Each provider reports `missing_key` with remediation instructions

#### AC4: `system_status` resource
- `tests/unit/mcp/test_diagnostics.py::test_collect_system_status_snapshot`
  - Given: System status helper invocation
  - When: Snapshot collected
  - Then: Payload includes timestamp and active task count
- `tests/unit/test_server.py::test_create_mcp_registers_ping_tool`
  - Verifies resource template `/system/status/{scope}` registered

#### AC5: Configuration validator ensures required env vars present/valid
- `src/legacy_web_mcp/config/settings.py` + `summarize_env_validation`
- `tests/unit/config/test_settings.py::test_missing_env_vars_reported`
  - Given: Env vars removed
  - When: `validate_env_vars`/`summarize_env_validation` invoked
  - Then: Each missing key returns remediation without exceptions

#### AC6: Error reporting includes remediation steps
- `tests/unit/config/test_settings.py::test_missing_env_vars_reported`
  - Verifies remediation text stored per key
- `tests/unit/mcp/test_diagnostics.py::test_perform_health_check`
  - Health payload includes remediation list when env vars missing

### Trace Hook

Trace matrix: docs/qa/assessments/1.2-trace-20250919.md
